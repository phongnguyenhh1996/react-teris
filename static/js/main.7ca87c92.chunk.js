(this["webpackJsonpteris-test"]=this["webpackJsonpteris-test"]||[]).push([[0],{200:function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),i=n(72),a=n.n(i),c=(n(86),n(87),n(88),n(2)),l=n(17),u=n(5),s=n(4),p=n(3);function f(){var t=Object(s.a)(["\n  width: ","px;\n  height: ","px;\n  position: absolute;\n  background: ",";\n  transition: left .3s ease, top .15s ease;\n  opacity: ",";\n  animation: "," 0.45s cubic-bezier(0.165, 0.840, 0.440, 1.000) both;\n"]);return f=function(){return t},t}function h(){var t=Object(s.a)(["\n  width: ","px;\n  height: ","px;\n  position: relative;\n  background-color: ",";\n  margin: auto;\n  animation: "," 0.3s linear;\n  overflow: hidden;\n"]);return h=function(){return t},t}function d(){var t=Object(s.a)(["\n  0% {\n    transform: scale(1);\n    filter: blur(0px);\n    opacity: 1;\n  }\n  100% {\n    transform: scale(2);\n    filter: blur(4px);\n    opacity: 0;\n  }\n"]);return d=function(){return t},t}function m(){var t=Object(s.a)(["\n  0% {\n    transform: translate(0);\n  }\n  20% {\n    transform: translate(-2px, 2px);\n  }\n  40% {\n    transform: translate(-2px, -2px);\n  }\n  60% {\n    transform: translate(2px, 2px);\n  }\n  80% {\n    transform: translate(2px, -2px);\n  }\n  100% {\n    transform: translate(0);\n  }\n"]);return m=function(){return t},t}var S,b=Object(p.c)(m()),v=Object(p.c)(d()),g={MainBoard:p.b.div(h(),(function(t){return t.cellSize*t.columns}),(function(t){return t.cellSize*t.rows}),(function(t){return t.theme.backgroundMainBoard}),(function(t){return t.isShake&&b})),MainBoard__cell:p.b.div.attrs((function(t){return{style:{top:t.position.top&&t.position.top*t.cellSize+"px",left:t.position.left&&t.position.left*t.cellSize+"px",right:t.position.right&&t.position.right*t.cellSize+"px",bottom:t.position.bottom&&t.position.bottom*t.cellSize+"px"}}}))(f(),(function(t){return t.cellSize}),(function(t){return t.cellSize}),(function(t){return t.position.color}),(function(t){return t.isShadow?.2:1}),(function(t){return t.position.isDestroying&&v}))},x=function(t){var e=Object(o.useRef)(null),n=!!(window.innerWidth<=991&&e.current)&&e.current.clientWidth,i=n?(n-30)/t.gameSettings.columns:t.gameSettings.cellSize,a=Object(u.a)({},t.gameSettings,{cellSize:i});return r.a.createElement("div",{ref:e},r.a.createElement(g.MainBoard,Object.assign({},a,{isShake:t.isShake,onAnimationEnd:function(){return t.setShake(!1)}}),t.cellsPosition.map((function(t){return r.a.createElement(g.MainBoard__cell,Object.assign({key:t.id},a,{position:t}))})),t.shadowShapePosition.map((function(t){return r.a.createElement(g.MainBoard__cell,Object.assign({key:"shadow-".concat(t.id)},a,{position:t,isShadow:!0}))}))))},O=(n(93),n(46)),y=n.n(O),j={t:{0:{matrix:[[1,1,1],[0,1,0]],center:[0,1]},1:{matrix:[[0,1],[1,1],[0,1]],center:[1,1]},2:{matrix:[[0,1,0],[1,1,1]],center:[1,1]},3:{matrix:[[1,0],[1,1],[1,0]],center:[1,0]}},l:{0:{matrix:[[1,1,1],[0,0,1]],center:[0,1]},1:{matrix:[[0,1],[0,1],[1,1]],center:[1,1]},2:{matrix:[[1,0,0],[1,1,1]],center:[1,1]},3:{matrix:[[1,1],[1,0],[1,0]],center:[1,0]}},i:{0:{matrix:[[1,1,1,1]],center:[0,1]},1:{matrix:[[1],[1],[1],[1]],center:[1,0]}},o:{0:{matrix:[[1,1],[1,1]],center:[0,0]}},j:{0:{matrix:[[1,1,1],[1,0,0]],center:[0,1]},1:{matrix:[[1,1],[0,1],[0,1]],center:[1,1]},2:{matrix:[[0,0,1],[1,1,1]],center:[1,1]},3:{matrix:[[1,0],[1,0],[1,1]],center:[1,0]}},z:{0:{matrix:[[1,1,0],[0,1,1]],center:[0,1]},1:{matrix:[[0,1],[1,1],[1,0]],center:[1,1]},2:{matrix:[[1,1,0],[0,1,1]],center:[1,1]},3:{matrix:[[0,1],[1,1],[1,0]],center:[1,0]}},s:{0:{matrix:[[0,1,1],[1,1,0]],center:[0,1]},1:{matrix:[[1,0],[1,1],[0,1]],center:[1,1]},2:{matrix:[[0,1,1],[1,1,0]],center:[1,1]},3:{matrix:[[1,0],[1,1],[0,1]],center:[1,0]}}},E={cellSize:25,columns:16,rows:24,fallSpeed:500,controlSpeed:60,fps:60,delayTime:50},P=["#A848E3","#E4E250","#F6A8DE","#ABE124","#D04D41","#F20B35","#2ED8DB","#1708EF","#F6847E","#FCB01E","#39FBBD","#6FFA14"],w=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.columns/2-1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=P[Math.round(Math.random()*(P.length-1))],c=j[t],l=c[e],u=l.center,s=e-1>=0?e-1:Object.keys(c).length-1,p=c[s],f=p.center,h=0,d=0;i&&(h=f[0]-u[0],d=f[1]-u[1]);for(var m=l.matrix,S=[],b=0;b<m.length;b++)for(var v=m[b],g=0;g<v.length;g++){var x=v[g];1===x&&S.push({top:o+b+h,left:n+g+d,isFalling:!0,userControl:!0,direction:e,color:r||a,id:y()(y()("shape-")+"-")})}return S},k=n(201),W={backgroundWrapper:["#fff","#222831"],backgroundMainBoard:["#eeeeee","#393e46"],title:["#00adb5","#00adb5"],mainHeading:["#00adb5","#00adb5"],textColor:["#222831","#eeeeee"]},M=n(15),C="light",D="dark",B=(S={},Object(M.a)(S,C,0),Object(M.a)(S,D,1),S),F=function(t){var e={},n=B[t];return Object.keys(W).forEach((function(t){e[t]=W[t][n]})),e};function z(){var t=Object(s.a)(["\n  color: ",";\n"]);return z=function(){return t},t}function L(){var t=Object(s.a)(["\n  position: fixed;\n  top: 10px;\n  right: 10px;\n"]);return L=function(){return t},t}function T(){var t=Object(s.a)(["\n  color: ",";\n  @media screen and (max-width: 991px){\n    font-size: 22px;\n  }\n"]);return T=function(){return t},t}function N(){var t=Object(s.a)(["\n  background-color: ",";\n  min-height: 100vh;\n  font-family: 'Righteous', cursive;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  position: relative;\n  &.no-hover-active {\n    button:hover, button:active, button:focus {\n      color: inherit !important;\n      background-color: inherit !important;\n      outline: inherit !important;\n      box-shadow: inherit !important;\n    }\n  }\n"]);return N=function(){return t},t}var A=p.b.div(N(),(function(t){return t.theme.backgroundWrapper})),I=p.b.h1(T(),(function(t){return t.theme.mainHeading})),R=p.b.div(L()),G=p.b.span(z(),(function(t){return t.theme.textColor})),_=n(47),K=n.n(_),H=n(77),J=n.n(H),U=n(78),q=n.n(U),X=function(){var t=Object.keys(j),e=t[K()(t.length-1)];return{currentShape:e,currentDirection:K()(Object.keys(j[e]).length-1)}},$=function(t){var e=J()(t),n=e.filter((function(t){return!t.userControl&&!t.isFalling}));return{cellPositionWithShape:e.filter((function(t){return t.userControl&&t.isFalling})),cellPositionWithoutShape:n}},Q=function(t,e){var n=e.filter((function(e){return function(t,e){return t.filter((function(t){return t.top+1===e.top&&t.left===e.left})).length>0}(t,e)})).length>0,o=t.filter((function(t){return t.top+1===E.rows})).length>0,r=n||o,i=e.filter((function(e){return function(t,e){return t.filter((function(t){return t.top===e.top&&t.left-1===e.left})).length>0}(t,e)})).length>0,a=t.filter((function(t){return t.left-1<0})).length>0,c=i||a,l=e.filter((function(e){return function(t,e){return t.filter((function(t){return t.top===e.top&&t.left+1===e.left})).length>0}(t,e)})).length>0,u=t.filter((function(t){return t.left+1>=E.columns})).length>0;return{isBottomCollusion:r,isLeftCollusion:c,isRightCollusion:l||u,isOverlapsed:t.filter((function(t){return t.left<0||t.left>=E.columns||t.top>=E.rows||e.filter((function(e){return e.left===t.left&&e.top===t.top})).length>0})).length>0}},V=function(t){if(0===t.length)return{};var e=t[0].left,n=t[0].top,o=t[0].left,r=t[0].top;return t.forEach((function(t){t.left<e&&(e=t.left),t.top<n&&(n=t.top),t.left>o&&(o=t.left),t.top>r&&(r=t.top)})),{xMin:e,yMin:n,xMax:o,yMax:r,color:t[0].color}},Y=function(t,e,n){var o=V(t),r=e.filter((function(t){return t.left>=o.xMin&&t.left<=o.xMax})),i=V(r);if(!i.yMin||!i.yMax)return w(n.currentShape,n.currentDirection,o.xMin,E.rows-1-(o.yMax-o.yMin),o.color);for(var a=[],c=i.yMin-(o.yMax-o.yMin+1);c<i.yMin+(o.yMax-o.yMin);c++){var l=w(n.currentShape,n.currentDirection,o.xMin,c,o.color);if(Q(l,r).isBottomCollusion){a=l;break}}return a},Z=function(t){var e=Object.keys(q()(t.filter((function(t){return t.isDestroying})),(function(t){return t.top}))).reverse();t=t.filter((function(t){return!t.isDestroying}));for(var n=[],o=function(o){var r=t.filter((function(t){return t.top===o}));if(0===r.length)return"continue";var i=e.filter((function(t){return o<t})).length,a=r.map((function(t){return Object(u.a)({},t,{top:t.top+i})}));n.push.apply(n,Object(c.a)(a))},r=E.rows-1;r>0;r--)o(r);return n},tt=X,et=$,nt=Q,ot=Y,rt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={},o=[],r=$([].concat(Object(c.a)(t),Object(c.a)(e))),i=r.cellPositionWithShape,a=r.cellPositionWithoutShape,l=Object(c.a)(a);return l.forEach((function(t){n[t.top]?n[t.top]+=1:n[t.top]=1})),Object.keys(n).forEach((function(t){n[t]===E.columns&&o.push(parseInt(t))})),o.length>0?(l=l.map((function(t){return Object(u.a)({},t,{isDestroying:o.includes(t.top)})})),[].concat(Object(c.a)(l),Object(c.a)(i))):[].concat(Object(c.a)(a),Object(c.a)(i))},it=function(t,e,n,o,r){if(!t.isBottomCollusion||t.isBottomCollusion&&!e.isPrepareOnGround){if(!t.isLeftCollusion&&n.left&&n.controlSpeedStep>=E.controlSpeed)o.cellPositionWithShape=o.cellPositionWithShape.map((function(t){return Object(u.a)({},t,{left:t.left-1})})),r(Y(o.cellPositionWithShape,o.cellPositionWithoutShape,e)),n.controlSpeedStep=0;if(!t.isRightCollusion&&n.right&&n.controlSpeedStep>=E.controlSpeed)o.cellPositionWithShape=o.cellPositionWithShape.map((function(t){return Object(u.a)({},t,{left:t.left+1})})),r(Y(o.cellPositionWithShape,o.cellPositionWithoutShape,e)),n.controlSpeedStep=0}},at=function(t,e,n,o,r,i,a){if(n.down){var l;o.isCaculatePoint=!0;var s=e.map((function(e,n){return Object(u.a)({},e,{isFalling:!1,userControl:!1,id:t.cellPositionWithShape[n].id})}));t.cellPositionWithShape=s;var p=X();r.currentShape=p.currentShape,r.currentDirection=p.currentDirection;var f=w(r.currentShape,r.currentDirection),h=Y(f,[].concat(Object(c.a)(t.cellPositionWithoutShape),Object(c.a)(t.cellPositionWithShape)),r);(l=t.cellPositionWithShape).push.apply(l,Object(c.a)(f)),i(h),a(!0),n.down=!1}},ct=function(t,e,n,o){if(e.rotate&&e.controlSpeedStep>=E.controlSpeed){e.controlSpeedStep=0;var r=(n.currentDirection+1)%Object.keys(j[n.currentShape]).length,i=V(t.cellPositionWithShape),a=i.xMin,l=i.yMin,u=i.color,s=function(t){var e=$(t),n=e.cellPositionWithShape,o=e.cellPositionWithoutShape;return Q(n,o).isOverlapsed?null:n}([].concat(Object(c.a)(t.cellPositionWithoutShape),Object(c.a)(w(n.currentShape,r,a,l,u,!0))));if(null!==s)n.currentDirection=r,t.cellPositionWithShape=s,o(Y(t.cellPositionWithShape,t.cellPositionWithoutShape,n))}},lt=function(t,e,n,o,r){if(t.cellPositionWithoutShape.filter((function(t){return t.isDestroying})).length>0){if(e.delayStep>=E.delayTime){t.cellPositionWithoutShape=Z(t.cellPositionWithoutShape),o(Y(t.cellPositionWithShape,t.cellPositionWithoutShape,n));var i=[].concat(Object(c.a)(t.cellPositionWithoutShape),Object(c.a)(t.cellPositionWithShape));return e.delayStep=0,r(i)}e.delayStep+=E.fps}},ut=function(t,e,n,o,r){if(e.fallStep+=E.fps,e.fallStep>=E.fallSpeed)if(e.fallStep=0,n.isBottomCollusion)if(o.isPrepareOnGround){var i;e.isCaculatePoint=!0,t.cellPositionWithShape=t.cellPositionWithShape.map((function(t){return Object(u.a)({},t,{isFalling:!1,userControl:!1})}));var a=X();o.currentShape=a.currentShape,o.currentDirection=a.currentDirection;var l=w(o.currentShape,o.currentDirection),s=Y(l,[].concat(Object(c.a)(t.cellPositionWithoutShape),Object(c.a)(t.cellPositionWithShape)),o);(i=t.cellPositionWithShape).push.apply(i,Object(c.a)(l)),r(s),o.isPrepareOnGround=!1}else o.isPrepareOnGround=!0;else t.cellPositionWithShape=t.cellPositionWithShape.map((function(t){return Object(u.a)({},t,{isFalling:!0,top:t.top+1})})),o.isPrepareOnGround=!1};function st(){var t=Object(s.a)(["\n  display: none;\n\n  &:focus + ","{\n    box-shadow: 0 0 1px #2196F3;\n  }\n\n  &:checked + ",":before {\n    transform: translateX(16px);\n  }\n"]);return st=function(){return t},t}function pt(){var t=Object(s.a)(["\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: ",';\n  -webkit-transition: .4s;\n  transition: .4s;\n  border-radius: 34px;\n\n  &:before{\n    position: absolute;\n    content: "";\n    height: 18px;\n    width: 18px;\n    left: 3px;\n    bottom: 3px;\n    background-color: white;\n    transition: .4s;\n    border-radius: 50%;\n  }\n']);return pt=function(){return t},t}function ft(){var t=Object(s.a)(["\n  position: relative;\n  display: inline-block;\n  width: 40px;\n  height: 24px;\n  margin: 0;\n"]);return ft=function(){return t},t}var ht=p.b.label(ft()),dt=p.b.div(pt(),(function(t){return t.value?"#1E81AE":"#ccc"})),mt=p.b.input(st(),dt,dt),St=function(t){return r.a.createElement(ht,null,r.a.createElement(mt,Object.assign({},t,{type:"checkbox",disabled:t.readOnly})),r.a.createElement(dt,{value:t.value}))},bt=function(t){return r.a.createElement(R,null,r.a.createElement("div",{className:"d-flex align-items-center"},r.a.createElement(G,{className:"mr-2"},"Light:"),r.a.createElement(St,t)))},vt=n(202),gt=n(16),xt=function(t){var e=t.handleKeyDown,n=t.handleKeyUp,o=function(t){return function(){return e({keyCode:t})}},i=function(t){return function(){return n({keyCode:t})}};return r.a.createElement("div",{className:"d-flex justify-content-between mt-3 mx-3"},r.a.createElement("div",null,r.a.createElement(vt.a,{className:"mr-3 py-3 px-4",outline:!0,color:"info",type:"button",onTouchEnd:i(37),onTouchStart:o(37)},r.a.createElement(gt.b,null)),r.a.createElement(vt.a,{className:"py-3 px-4",outline:!0,color:"info",type:"button",onTouchEnd:i(39),onTouchStart:o(39)},r.a.createElement(gt.c,null))),r.a.createElement("div",null,r.a.createElement(vt.a,{className:"mr-3 py-3 px-4",outline:!0,color:"info",type:"button",onTouchEnd:i(40),onTouchStart:o(40)},r.a.createElement(gt.a,null)),r.a.createElement(vt.a,{className:"py-3 px-4",outline:!0,color:"info",type:"button",onTouchEnd:i(38),onTouchStart:o(38)},r.a.createElement(gt.d,null))))},Ot={fallStep:0,isCaculatePoint:!1,delayStep:0},yt=Object(u.a)({isPrepareOnGround:!1},tt()),jt=w(yt.currentShape,yt.currentDirection),Et={left:!1,right:!1,rotate:!1,down:!1,controlSpeedStep:E.controlSpeed};var Pt=function(){var t=Object(o.useState)(jt),e=Object(l.a)(t,2),n=e[0],i=e[1],a=Object(o.useState)(!1),u=Object(l.a)(a,2),s=u[0],f=u[1],h=Object(o.useState)(ot(jt,[],yt)),d=Object(l.a)(h,2),m=d[0],S=d[1];Object(o.useEffect)((function(){var t=setInterval((function(){var t=et(n);lt(t,Ot,yt,S,i);var e=nt(t.cellPositionWithShape,t.cellPositionWithoutShape);it(e,yt,Et,t,S),ut(t,Ot,e,yt,S),at(t,m,Et,Ot,yt,S,f),ct(t,Et,yt,S);var o=[].concat(Object(c.a)(t.cellPositionWithoutShape),Object(c.a)(t.cellPositionWithShape));Ot.isCaculatePoint&&(o=rt(o),Ot.isCaculatePoint=!1),i(o)}),E.fps);return function(){clearInterval(t)}}),[n,m]);var b=function(t){switch(t.keyCode){case 37:Et.left=!0,Et.controlSpeedStep+=E.fps;break;case 39:Et.right=!0,Et.controlSpeedStep+=E.fps;break;case 38:Et.rotate=!0,Et.controlSpeedStep+=E.fps;break;case 40:Et.down=!0}},v=function(t){switch(t.keyCode){case 37:Et.left=!1,Et.controlSpeedStep=E.controlSpeed;break;case 39:Et.right=!1,Et.controlSpeedStep=E.controlSpeed;break;case 38:Et.rotate=!1,Et.controlSpeedStep+=E.controlSpeed}};Object(o.useEffect)((function(){window.addEventListener("keydown",b),window.addEventListener("keyup",v);var t=document.querySelector(".hover-active");function e(){t.classList.remove("hover-active"),t.classList.add("no-hover-active"),t.removeEventListener("touchstart",e)}return t.addEventListener("touchstart",e),function(){window.removeEventListener("keydown",b),window.removeEventListener("keyup",v),t.removeEventListener("touchstart",e)}}),[]);var g=Object(o.useState)(localStorage.getItem("theme")||C),O=Object(l.a)(g,2),y=O[0],j=O[1],P=y===C;return r.a.createElement(p.a,{theme:F(y)},r.a.createElement(A,{className:"hover-active"},r.a.createElement(bt,{value:P,onChange:function(){var t=y!==C?C:D;localStorage.setItem("theme",t),j(t)},isReadOnly:!0}),r.a.createElement(k.a,{className:"App"},r.a.createElement(I,{className:"text-center"},"TERIS RACE"),r.a.createElement(x,{gameSettings:E,cellsPosition:n,shadowShapePosition:m,isShake:s,setShake:f}),r.a.createElement(xt,{handleKeyUp:v,handleKeyDown:b}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(r.a.createElement(Pt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},81:function(t,e,n){t.exports=n(200)},88:function(t,e,n){},93:function(t,e,n){}},[[81,1,2]]]);
//# sourceMappingURL=main.7ca87c92.chunk.js.map